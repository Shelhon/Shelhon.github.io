<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="学习,框架,spring,"><meta name="description" content="大概内容   基于aspectj的注解aop操作 spring的jdbcTemplate操作 spring配置连接池 spring事务管理"><meta name="keywords" content="学习,框架,spring"><meta property="og:type" content="article"><meta property="og:title" content="Spring 框架学习(二)"><meta property="og:url" content="https://www.shelhon.cn/posts/14042445.html"><meta property="og:site_name" content="无问西东"><meta property="og:description" content="大概内容   基于aspectj的注解aop操作 spring的jdbcTemplate操作 spring配置连接池 spring事务管理"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://www.shelhon.cn/posts/14042445/1.png"><meta property="og:updated_time" content="2018-07-30T09:44:59.385Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Spring 框架学习(二)"><meta name="twitter:description" content="大概内容   基于aspectj的注解aop操作 spring的jdbcTemplate操作 spring配置连接池 spring事务管理"><meta name="twitter:image" content="https://www.shelhon.cn/posts/14042445/1.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!0,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.shelhon.cn/posts/14042445.html"><title>Spring 框架学习(二) | 无问西东</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3275656b1c327868bf311aa7c5fdabd2";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/Shelhon/Shelhon.github.io" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64ceaa;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">无问西东</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">糊涂脸水聪明枕</h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404.html/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br> 公益404</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.shelhon.cn/posts/14042445.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Qsx"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="无问西东"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">Spring 框架学习(二)</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-26T09:53:09+08:00">2018-07-26</time></span> <span class="post-updated">&nbsp; | &nbsp; 更新于 <time itemprop="dateUpdated" datetime="2018-07-30T17:44:59+08:00" content="2018-07-30">2018-07-30</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/学习过程/" itemprop="url" rel="index"><span itemprop="name">学习过程</span></a></span></span> <span class="post-meta-divider">|</span><span class="page-pv"><i class="fa fa-file-o"></i><span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">1,649</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">8</span></div></div></header><div class="post-body" itemprop="articleBody"><p><center> <strong><font size="5">大概内容</font></strong></center></p><ol><li>基于aspectj的注解aop操作</li><li>spring的jdbcTemplate操作</li><li>spring配置连接池</li><li>spring事务管理</li></ol><a id="more"></a><h1 id="基于aspectj的注解aop操作"><a href="#基于aspectj的注解aop操作" class="headerlink" title="基于aspectj的注解aop操作"></a>基于aspectj的注解aop操作</h1><pre><code>1. 使用注解方式创建aop操作
</code></pre><p>第一步 ：创建对象<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 1  配置对象 --&gt; &lt;bean id=&quot;book&quot; class=&quot;cn.shelhon.cn.shelhon.aop.Book&quot;&gt; &lt;/bean&gt; &lt;bean id=&quot;myBook&quot; class=&quot;cn.shelhon.cn.shelhon.aop.Book&quot;&gt; &lt;/bean&gt;</span><br></pre></td></tr></table></figure><p></p><p> 第二步 ：在spring核心配置文件里面开启AOP操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 开启aop操作 --&gt; &lt;aop:aspectj-autoproxy&gt; &lt;/aop:aspectj-autoproxy&gt;</span><br></pre></td></tr></table></figure><p>第三步 ： 在增强类上面使用注解完成aop操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Aspect public class Mybook &#123;</span><br><span class="line">   //在方法上面使用注解完成增强配置</span><br><span class="line">  @Before(value = &quot;execution(* cn.shelhon.aop.Book.*(..)&quot;)</span><br></pre></td></tr></table></figure><h1 id="Spring的jdbcTemplate操作"><a href="#Spring的jdbcTemplate操作" class="headerlink" title="Spring的jdbcTemplate操作"></a>Spring的jdbcTemplate操作</h1><p> <strong>实现crud操作</strong></p><pre><code>- 增加、修改、删除，调用模板update方法
- 查询某个值时候，调用queryForObject方法
- 自己写实现类封装数据
- 查询对象，调用queryForObject方法
- 查询list集合，调用query方法
</code></pre><ol><li><p>spring框架一站式框架</p><ul><li>针对javaee三层，每一层都有解决技术</li><li>在dao层，使用 jdbcTemplate</li></ul></li><li><p>spring对不同的持久化层技术都进行封装</p></li></ol> <img src="/posts/14042445/1.png"><p>其中jdbcTemplate对jdbc进行封装</p><ol start="3"><li>jdbcTemplate使用和dbutils使用很相似，都数据库进行crud操作</li></ol><h2 id="增加"><a href="#增加" class="headerlink" title="增加"></a>增加</h2><ol><li><p>导入jdbcTemplate使用的jar包</p></li><li><p>创建对象，设置数据库信息</p></li><li><p>创建JdbcTemplate对象，设置数据源</p></li><li><p>调用jdbcTemplate对象里面的方法</p></li></ol><p> <strong>操作的时候，记得还要导入驱动数据库的jar包</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加操作 </span></span><br><span class="line"><span class="meta">@Test</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">//创建对象，设置数据库信息   </span></span><br><span class="line">	DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line"></span><br><span class="line">	dataSource.setDriverClassName(<span class="string">"conm.mysql.jdbc.Driver"</span>);</span><br><span class="line"></span><br><span class="line">	dataSource.setUrl(<span class="string">"jdbc:mysql://test"</span>);</span><br><span class="line"></span><br><span class="line">	dataSource.setUsername(<span class="string">"root"</span>);</span><br><span class="line"></span><br><span class="line">	dataSource.setPassword(<span class="string">"12345"</span>); </span><br><span class="line">    </span><br><span class="line"> <span class="comment">// 创建JdbcTemplate对象，设置数据源  </span></span><br><span class="line">	JdbcTemplate jdbcTempalate = <span class="keyword">new</span> JdbcTemplate(dataSource);    </span><br><span class="line"><span class="comment">//调用jdbcTemplate对象里面的方法</span></span><br><span class="line">	String sql = <span class="string">"insert into user value(?,?)"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> rows = jdbcTempalate.update(sql,<span class="string">"lucy"</span>,<span class="string">"22"</span>);</span><br><span class="line"></span><br><span class="line">	System.out.println(rows);  </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>特别要注意的是，在运行的时候报错出现的问题<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is java.sql.SQLException: Unknown character set index for field &apos;255&apos; received from server.</span><br></pre></td></tr></table></figure><p></p><p>这个问题是由于我使用的数据库版本比较新，导致旧的mysql-connector-java的版本使用的时候报错。<br>(1) MYSQL 5.5 之前， UTF8 编码只支持1-3个字节;从MYSQL5.5开始，可支持4个字节UTF编码utf8mb4;如emoji表情需要使用utf8mb4</p><p>(2) 如果服务器级使用的编码是utf8mb4(在客户端链接后使用sql语句show variables like ‘char%’可查看所有编码)，而mysql的jar包低版本不支持utf8mb4,连接时报错”Unknown character set index for field ‘224’ received from server.”</p><p>(3) 建议使用mysql-connector-java-5.1.30-bin.jar</p><p>(4) 注意：如果数据库不支持utf8mb4，使用mysql-connector-java-5.1.30-bin.jar的jar包时则会报错，此时应该使用低版本的jar包。</p><p>然后这个时候我又用了最新版本的mysql-connector的jar包<br>又报错<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedClassVersionError: com/mysql/jdbc/Driver : Unsupported major.minor version 52.0</span><br></pre></td></tr></table></figure><p></p><p>这种问题是jdk版本和mysql数据库版本不兼容<br>从网上寻找的答案有如下：</p><p>1、jdk7+老版5.0驱动com/mysql/jdbc/Driver</p><p>2、jdk8+新版6.0驱动com/mysql/cj/jdbc/Driver</p><p>所以就是最新的jar是不能跟jdk1.7搭配使用的。<br>最后解决问题的是这样的搭配</p><ul><li>jdk1.7.0_80</li><li>mysql-connector-java 5.1.46</li><li>spring-jdbc 4.2.4.RELEASE</li></ul><h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>更新的方法跟增加差不多。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用jdbcTemplate对象里面的方法 </span></span><br><span class="line">String sql = <span class="string">"update user set password=? where name=?"</span>; </span><br><span class="line"><span class="keyword">int</span> rows = jdbcTemplate.update(sql,<span class="string">"lucy"</span>,<span class="string">"99"</span>); </span><br><span class="line">System.out.println(rows);</span><br></pre></td></tr></table></figure><h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p>删除也是同理<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用jdbcTemplate对象里面的方法 </span></span><br><span class="line">String sql = <span class="string">"delete from user where name=?"</span>; </span><br><span class="line"><span class="keyword">int</span> rows = jdbcTemplate.update(sql,<span class="string">"null"</span>);  </span><br><span class="line">System.out.println(rows);</span><br></pre></td></tr></table></figure><p></p><h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p>1、查询表中有多少记录<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建JdbcTemplate对象，设置数据源</span></span><br><span class="line">JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);</span><br><span class="line">String sql = <span class="string">"select count(*) from user"</span>;</span><br><span class="line"><span class="keyword">int</span> count =jdbcTemplate.queryForObject(sql,Integer.class);</span><br><span class="line">System.out.println(count); &#125;</span><br></pre></td></tr></table></figure><p></p><p>2、查询返回对象<br>jdbc底层原理<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJDBC</span><span class="params">()</span></span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">PreparedStatement psmt =<span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">      Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"><span class="comment">//创建连接</span></span><br><span class="line">conn = DriverManager.getConnection(<span class="string">"jdbc:mysql:///test"</span>, <span class="string">"root"</span>, <span class="string">"12345"</span>);</span><br><span class="line"><span class="comment">//编写sql语句</span></span><br><span class="line">String sql = <span class="string">"select * from user where name =?"</span>;</span><br><span class="line"><span class="comment">//预编译sql语句</span></span><br><span class="line">psmt = conn.prepareStatement(sql);</span><br><span class="line"><span class="comment">//设置参数值</span></span><br><span class="line">psmt.setString(<span class="number">1</span>, <span class="string">"lucy"</span>);</span><br><span class="line"><span class="comment">//遍历结果集</span></span><br><span class="line">rs =psmt.executeQuery();</span><br><span class="line"> <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">         <span class="comment">//得到返回值</span></span><br><span class="line">String username =rs.getString(<span class="string">"name"</span>);</span><br><span class="line">String password = rs.getString(<span class="string">"password"</span>);</span><br><span class="line">  <span class="comment">//放到User对象里面</span></span><br><span class="line">User user =<span class="keyword">new</span> User();</span><br><span class="line">user.setUsername(username);</span><br><span class="line">user.setPassword(password);</span><br><span class="line">System.out.println(user);</span><br><span class="line">  &#125;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">   e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">       rs.close();</span><br><span class="line">psmt.close();</span><br><span class="line">conn.close();;</span><br><span class="line">  &#125;<span class="keyword">catch</span>(SQLException e)&#123;</span><br><span class="line">         e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>User.java代码<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.shelhon.jdbc;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> String username;</span><br><span class="line"> <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> username;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> password;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.username = username;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.password = password;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">            <span class="string">"username='"</span> + username + <span class="string">'\''</span> +</span><br><span class="line">            <span class="string">", password='"</span> + password + <span class="string">'\''</span> +</span><br><span class="line">            <span class="string">'&#125;'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>具体的实现<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testObject</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">//创建对象以及设置数据库信息</span></span><br><span class="line">  DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">  dataSource.setDriverClassName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">  dataSource.setUrl(<span class="string">"jdbc:mysql:///test"</span>);</span><br><span class="line">  dataSource.setUsername(<span class="string">"root"</span>);</span><br><span class="line">  dataSource.setPassword(<span class="string">"12345"</span>);</span><br><span class="line">  <span class="comment">// 创建JdbcTemplate对象，设置数据源</span></span><br><span class="line">  JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);    <span class="comment">//写sql语句，根据name来查询</span></span><br><span class="line">  String sql =<span class="string">"select * from user where name = ?"</span>;</span><br><span class="line">  <span class="comment">//调用jdbctempla的方法实现</span></span><br><span class="line"> <span class="comment">//第二个参数是接口ROWMapper，需要自己写个类,自己做数据封装  User user=jdbcTemplate.queryForObject(sql,new MyRowMapper(),"rose");</span></span><br><span class="line">  System.out.println(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyRowMapper</span> <span class="keyword">implements</span> <span class="title">RowMapper</span>&lt;<span class="title">User</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> User <span class="title">mapRow</span><span class="params">(ResultSet rs, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">      <span class="comment">//从结果集里把数据拿到</span></span><br><span class="line">  String username = rs.getString(<span class="string">"name"</span>);</span><br><span class="line">  String password = rs.getString(<span class="string">"password"</span>);</span><br><span class="line">  <span class="comment">//把得到的数据封装到对象里面</span></span><br><span class="line">  User user = <span class="keyword">new</span> User();</span><br><span class="line">  user.setUsername(username);</span><br><span class="line">  user.setPassword(password);</span><br><span class="line"> <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>3、查询返回list集合<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testList</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">//创建对象以及设置数据库信息</span></span><br><span class="line">  DriverManagerDataSource dataSource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">  dataSource.setDriverClassName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">  dataSource.setUrl(<span class="string">"jdbc:mysql:///test"</span>);</span><br><span class="line">  dataSource.setUsername(<span class="string">"root"</span>);</span><br><span class="line">  dataSource.setPassword(<span class="string">"12345"</span>);</span><br><span class="line">  <span class="comment">// 创建JdbcTemplate对象，设置数据源</span></span><br><span class="line">  JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(dataSource);    <span class="comment">//写sql语句，根据name来查询</span></span><br><span class="line">  String sql =<span class="string">"select * from user"</span>;</span><br><span class="line">  <span class="comment">//调用jdbctempla的方法实现</span></span><br><span class="line"> <span class="comment">//第二个参数是接口ROWMapper，需要自己写个类,自己做数据封装</span></span><br><span class="line">List&lt;User&gt; list =jdbcTemplate.query(sql,<span class="keyword">new</span> MyRowMapper());</span><br><span class="line">  System.out.println(list); &#125;</span><br></pre></td></tr></table></figure><p></p><h1 id="Spring配置连接池"><a href="#Spring配置连接池" class="headerlink" title="Spring配置连接池"></a>Spring配置连接池</h1><ol><li>配置c3p0连接池</li><li>dao注入jdbcTemplate操作</li></ol><h1 id="Spring事务管理"><a href="#Spring事务管理" class="headerlink" title="Spring事务管理"></a>Spring事务管理</h1><ol><li>事务概念</li><li>spring进行事务管理api<pre><code>- spring针对不同的dao层框架提供不同的实现类
</code></pre></li><li>spring进行事务配置（声明式）<pre><code>- 基于xml配置文件
- 基于注解方式
</code></pre></li></ol></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>Just for fun!</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Qsx 微信支付"><p>微信支付</p></div></div></div></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------<i class="fa fa-paw"></i> 文章已经到尾<i class="fa fa-paw"></i> -------------</div></div></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/学习/" rel="tag"># 学习</a> <a href="/tags/框架/" rel="tag"># 框架</a> <a href="/tags/spring/" rel="tag"># spring</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/ada285ba.html" rel="next" title="使用IDEA遇到的问题记录"><i class="fa fa-chevron-left"></i> 使用IDEA遇到的问题记录</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Qsx"><p class="site-author-name" itemprop="name">Qsx</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">3</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Shelhon" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:ppp00qqq@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="http://weibo.com/qsxmybaby" target="_blank" title="微博"><i class="fa fa-fw fa-weibo"></i> 微博</a></span><span class="links-of-author-item"><a href="https://zhihu.com/people/shelhon" target="_blank" title="知乎"><i class="fa fa-fw fa-globe"></i> 知乎</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://www.kofes.cn/" title="cz" target="_blank">cz</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#基于aspectj的注解aop操作"><span class="nav-number">1.</span> <span class="nav-text">基于aspectj的注解aop操作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring的jdbcTemplate操作"><span class="nav-number">2.</span> <span class="nav-text">Spring的jdbcTemplate操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#增加"><span class="nav-number">2.1.</span> <span class="nav-text">增加</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更新"><span class="nav-number">2.2.</span> <span class="nav-text">更新</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除"><span class="nav-number">2.3.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查询"><span class="nav-number">2.4.</span> <span class="nav-text">查询</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring配置连接池"><span class="nav-number">3.</span> <span class="nav-text">Spring配置连接池</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring事务管理"><span class="nav-number">4.</span> <span class="nav-text">Spring事务管理</span></a></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Qsx</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">7.6k</span></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/love.js"></script></body></html>