<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="学习,框架,struts2,"><meta name="description" content="主要内容   struts2值栈struts2拦截器"><meta name="keywords" content="学习,框架,struts2"><meta property="og:type" content="article"><meta property="og:title" content="struts2学习(二）"><meta property="og:url" content="https://www.shelhon.cn/posts/3a01fcdf.html"><meta property="og:site_name" content="无问西东"><meta property="og:description" content="主要内容   struts2值栈struts2拦截器"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/1.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/2.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/3.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/4.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/5.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/6.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/7.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/8.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/9.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/10.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/11.png"><meta property="og:image" content="https://www.shelhon.cn/posts/3a01fcdf/12.png"><meta property="og:updated_time" content="2018-08-04T13:36:16.418Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="struts2学习(二）"><meta name="twitter:description" content="主要内容   struts2值栈struts2拦截器"><meta name="twitter:image" content="https://www.shelhon.cn/posts/3a01fcdf/1.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!0,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.shelhon.cn/posts/3a01fcdf.html"><title>struts2学习(二） | 无问西东</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3275656b1c327868bf311aa7c5fdabd2";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/Shelhon/Shelhon.github.io" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64ceaa;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">无问西东</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">糊涂脸水聪明枕</h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404.html/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br> 公益404</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.shelhon.cn/posts/3a01fcdf.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Qsx"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="无问西东"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">struts2学习(二）</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-03T14:35:46+08:00">2018-08-03</time></span> <span class="post-updated">&nbsp; | &nbsp; 更新于 <time itemprop="dateUpdated" datetime="2018-08-04T21:36:16+08:00" content="2018-08-04">2018-08-04</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/学习过程/" itemprop="url" rel="index"><span itemprop="name">学习过程</span></a></span></span> <span class="post-meta-divider">|</span><span class="page-pv"><i class="fa fa-file-o"></i><span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">3,836</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">16</span></div></div></header><div class="post-body" itemprop="articleBody"><center><strong>主要内容</strong></center><p> struts2值栈<br>struts2拦截器</p><hr><a id="more"></a><h1 id="struts2值栈"><a href="#struts2值栈" class="headerlink" title="struts2值栈"></a>struts2值栈</h1><h2 id="ognl概述"><a href="#ognl概述" class="headerlink" title="ognl概述"></a>ognl概述</h2><ol><li>EL表达式在jsp中获取域对象里面的值</li><li>OGNL也是一种表达式，这个表达式功能更加强大<br>（1）在struts2里面操作值栈数据<br>（2）一般把ognl在struts2操作：和struts2标签一起使用操作值栈</li><li>OGNL不是struts2的一部分，单独的项目，经常和struts2一起使用<br>（1）使用ognl时候首先导入jar包，struts2提供jar包</li></ol><hr><h2 id="OGNL入门案例"><a href="#OGNL入门案例" class="headerlink" title="OGNL入门案例"></a>OGNL入门案例</h2><ol><li><p>使用ognl+struts2标签实现计算字符串长度<br>支持对象方法调用，比如objName.methodName()<br>在Java代码中，调用字符串length()</p></li><li><p>使用struts2标签</p></li></ol><p>（1）使用jstl时候，导入jar包之外，在jsp页面中引入标签库使用struts2标签时候，在jsp中引入标签库<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">prefix</span>=<span class="string">"s"</span> <span class="attr">uri</span>=<span class="string">"/struts-tags"</span> %&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>（2）使用struts2标签实现操作<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用ognl加struts2标签实现计算字符串长度 --&gt;</span> <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"'asdasd'.length()"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p></p><hr><h2 id="什么是值栈"><a href="#什么是值栈" class="headerlink" title="什么是值栈"></a>什么是值栈</h2><ol><li><p>之前在web阶段，在servlet里面进行操作，把数据放到域对象里面，在页面中使用el表达式获取到，域对象在一定范围内，存值和取值</p></li><li><p>在struts2里面提供本身一种存储机制，类似于域对象，是值栈，可以存值和取值<br>（1）在action里面把数据放到值栈里面，在页面中获取到值栈数据</p></li><li><p>servlet和action区别<br>（1）Servlet：默认在第一次访问时候创建，创建一次，单实例对象<br>（2）Action：访问时候创建，每次访问action时候，都会创建action对象，创建多次，多实例对象</p></li><li><p>值栈存储位置<br>（1）每次访问action时候，都会创建action对象，<br>（2）在每个action对象里面都会有一个值栈对象（只有一个）</p></li></ol><hr><h3 id="获取值栈对象"><a href="#获取值栈对象" class="headerlink" title="获取值栈对象"></a>获取值栈对象</h3><ol><li>获取值栈对象有多种方式<br>（1）常用方式：使用ActionContext类里面的方法得到值栈对象<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   <span class="comment">//获取ActionContext类对象</span></span><br><span class="line">  ActionContext context =ActionContext.getContext();</span><br><span class="line">   <span class="comment">//调用方法得到值栈</span></span><br><span class="line">  ValueStack stack1 = context.getValueStack();</span><br><span class="line">   <span class="keyword">return</span> NONE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><hr><h3 id="值栈内部结构"><a href="#值栈内部结构" class="headerlink" title="值栈内部结构"></a>值栈内部结构</h3><ol><li><p>值栈分为两部分：</p><p> 第一部分 root，结构是list集合</p><ul><li><p>一般操作都是root里面数据</p><p>第二部分 context，结构map集合</p></li></ul></li></ol><p>具体看下图</p> <img src="/posts/3a01fcdf/1.png"><hr> <img src="/posts/3a01fcdf/2.png"><ol start="2"><li>struts2里面标签 s:debug，使用这个标签可以查看值栈结构和存储值<br>（1）访问action，执行action的方法有返回值，配置返回值到jsp页面中，在jsp页面中使用这个标签</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--struts2标签查看值栈结构--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">s:debug</span>&gt;</span><span class="tag">&lt;/<span class="name">s:debug</span>&gt;</span></span><br></pre></td></tr></table></figure><p>就会多一个debug按钮来查看信息</p><p>action对象里面有值栈对象<br>值栈对象里面有action引用</p><hr><h3 id="向值栈放数据"><a href="#向值栈放数据" class="headerlink" title="向值栈放数据"></a>向值栈放数据</h3><h4 id="向值栈放数据多种方式"><a href="#向值栈放数据多种方式" class="headerlink" title="向值栈放数据多种方式"></a>向值栈放数据多种方式</h4><p>第一种 获取值栈对象，调用值栈对象里面的 set 方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   <span class="comment">//第一种方法 获取值栈对象里面的set方法</span></span><br><span class="line"> <span class="comment">//获取值栈对象</span></span><br><span class="line">  ActionContext context = ActionContext.getContext();</span><br><span class="line">   ValueStack stack = context.getValueStack();</span><br><span class="line">   <span class="comment">//调用方法set方法</span></span><br><span class="line">  stack.set(<span class="string">"username"</span>,<span class="string">"shelhon"</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br></pre></td></tr></table></figure><p>debug页面就会多一个入栈 java.util.HashMap</p><p>第二种 获取值栈对象，调用值栈对象里面的 push方法<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用方法push方法</span></span><br><span class="line"> stack.push(<span class="string">"abdc"</span>);</span><br></pre></td></tr></table></figure><p></p><p>又多一个入栈 ：java.lang.String</p><p>第三种 在action定义变量，生成变量的get方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   <span class="comment">//在执行方法里面向变量来赋值</span></span><br><span class="line">  name =<span class="string">"asdasd"</span>;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这种方法直接在原来的值栈上面写入数据，不需要生成新的值栈来存储，可以节省空间</p><hr><h4 id="向值栈放对象"><a href="#向值栈放对象" class="headerlink" title="向值栈放对象"></a>向值栈放对象</h4><ol><li>实现步骤</li></ol><p>第一步 定义对象变量<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1定义变量</span></span><br><span class="line"> <span class="keyword">private</span> User user = <span class="keyword">new</span> User();</span><br></pre></td></tr></table></figure><p></p><p>第二步 生成变量的get方法<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>第三步 在执行的方法里面向对象中设置值<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   <span class="comment">//3 向值栈的user里面放数据</span></span><br><span class="line">  user.setUsername(<span class="string">"luck"</span>);</span><br><span class="line">   user.setPassword(<span class="string">"123"</span>);</span><br><span class="line">   user.setAddress(<span class="string">"gz"</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="向值栈放list集合"><a href="#向值栈放list集合" class="headerlink" title="向值栈放list集合"></a>向值栈放list集合</h4><p>第一步 定义list集合变量<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br></pre></td></tr></table></figure><p></p><p>第二步 生成变量的get方法<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>第三步 在执行的方法里面向list集合设置值<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   User user1= <span class="keyword">new</span> User();</span><br><span class="line">   user1.setUsername(<span class="string">"ben"</span>);</span><br><span class="line">   user1.setAddress(<span class="string">"gz"</span>);</span><br><span class="line">   user1.setPassword(<span class="string">"111"</span>);</span><br><span class="line"></span><br><span class="line">   User user2 =<span class="keyword">new</span> User();</span><br><span class="line">   user2.setUsername(<span class="string">"jack"</span>);</span><br><span class="line">   user2.setPassword(<span class="string">"009"</span>);</span><br><span class="line">   user2.setAddress(<span class="string">"cd"</span>);</span><br><span class="line"></span><br><span class="line">   list.add(user1);</span><br><span class="line">   list.add(user2);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><hr><h3 id="从值栈获取数据"><a href="#从值栈获取数据" class="headerlink" title="从值栈获取数据"></a>从值栈获取数据</h3><p>使用struts2的标签+ognl表达式获取值栈数据<br>&lt;s:property value=”ognl表达式”/&gt;</p><h4 id="获取字符串"><a href="#获取字符串" class="headerlink" title="获取字符串"></a>获取字符串</h4><ol><li>向值栈放字符串</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValueStackAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义变量</span></span><br><span class="line">   <span class="keyword">private</span> String username;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> username;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">     <span class="comment">//给变量赋值</span></span><br><span class="line">      username=<span class="string">"shelhon"</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在jsp使用struts2标签+ognl表达式获取</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"username"</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="获取对象"><a href="#获取对象" class="headerlink" title="获取对象"></a>获取对象</h4><ol><li>向值栈放对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">this</span>.user = user;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> User user =<span class="keyword">new</span> User();</span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">      user.setUsername(<span class="string">"asd"</span>);</span><br><span class="line">      user.setPassword(<span class="string">"222"</span>);</span><br><span class="line">      user.setAddress(<span class="string">"gz"</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>在页面中获取值<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"user.username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"user.password"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"user.address"</span>/&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="获取list集合"><a href="#获取list集合" class="headerlink" title="获取list集合"></a>获取list集合</h4><p>三种方法<br>一开始先把list放到值栈去<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">   User user1= <span class="keyword">new</span> User();</span><br><span class="line">   user1.setUsername(<span class="string">"qsx"</span>);</span><br><span class="line">   user1.setAddress(<span class="string">"gz"</span>);</span><br><span class="line">   user1.setPassword(<span class="string">"111"</span>);</span><br><span class="line">   User user2 =<span class="keyword">new</span> User();</span><br><span class="line">   user2.setUsername(<span class="string">"jack"</span>);</span><br><span class="line">   user2.setPassword(<span class="string">"009"</span>);</span><br><span class="line">   user2.setAddress(<span class="string">"cd"</span>);</span><br><span class="line">   list.add(user1);</span><br><span class="line">   list.add(user2);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br></pre></td></tr></table></figure><p></p><p>第一种</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 第一种方式 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"list[0].username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"list[0].possword"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"list[0].address"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"list[1].username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"list[1].possword"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"list[1].address"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>第二种</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用struts2标签，类似jst1的foreach标签  &lt;s:iterator&gt;遍历值栈的list集合--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:iterator</span> <span class="attr">value</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 遍历list得到list里面每一个user对象 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"password"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"address"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">s:iterator</span>&gt;</span></span><br></pre></td></tr></table></figure><p>第三种<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:iterator</span> <span class="attr">value</span>=<span class="string">"list"</span> <span class="attr">var</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 遍历值栈list集合，得到每个user对象</span></span><br><span class="line"><span class="comment"> 机制：把每次遍历出来的user对象放到context里面 获取context里面的数据特点：写ognl表达式， 使用特殊符号 # --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#user.username"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#user.username"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#user.username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">s:iterator</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><h3 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h3><p> 先获取set方法设置的值</p><ol><li>使用set方法向值栈放数据，获取<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ValueStack stack = context.getValueStack();</span><br><span class="line">stack.set(<span class="string">"shelhon"</span>,<span class="string">"shelhon.cn"</span>);</span><br></pre></td></tr></table></figure></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"shelhon"</span>/&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>使用push方法向值栈放数据，获取</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stack.push(<span class="string">"asdb"</span>);</span><br></pre></td></tr></table></figure><p>（1）使用push方法设置值，没有名称，只有设置的值<br>（2）向值栈放数据，把向值栈放数据存到数组里面，数组名称 top，根据数组获取值<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"[0].top"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p></p><ol start="3"><li>EL表达式获取值栈数据<br>首先要先导入两个jar包，分别是jstl.jar和standard.jar<br>切记用idea的maven时，需要把这个jar包导入到tomcat里面去，具体看另一篇笔记，配置依赖的问题。</li></ol><p>在jsp上面补个标签<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@taglib</span> <span class="attr">uri</span>=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> <span class="attr">prefix</span>=<span class="string">"c"</span>%&gt;</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c:forEach</span> <span class="attr">items</span>=<span class="string">"$&#123;list &#125;"</span> <span class="attr">var</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    $&#123;user.username &#125;</span><br><span class="line"> $&#123;user.password &#125;</span><br><span class="line"> $&#123;user.address &#125; <span class="tag">&lt;/<span class="name">c:forEach</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>EL表达式获取域对象值</li><li>向域对象里面放值使用setAttribute方法，获取值使用getAttribute方法</li><li><p>底层增强request对象里面的方法getAttribute方法<br>（1） 首先从request域获取值，如果获取到，直接返回<br>（2）如果从request域获取不到值，到值栈中把值获取出来，把值放到域对象里面</p></li><li><p>源码：<br>public class StrutsRequestWrapper extends HttpServletRequestWrapper<br>public Object getAttribute(String key)</p></li></ul><p>不建议这么做，性能很低</p><h2 id="OGNL的-、-使用"><a href="#OGNL的-、-使用" class="headerlink" title="OGNL的#、%使用"></a>OGNL的#、%使用</h2><h3 id="关于-号的使用"><a href="#关于-号的使用" class="headerlink" title="关于 # 号的使用"></a>关于 # 号的使用</h3><p> 使用#获取context里面数据</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#user.username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#user.username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#user.username"</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="关于-的使用"><a href="#关于-的使用" class="headerlink" title="关于 % 的使用"></a>关于 % 的使用</h3><ol><li>在struts2标签中表单标签<br>（1） 在struts2标签里面使用ognl表达式，如果直接在struts2表单标签里面使用ognl表达式不识别，只有%之后才会识别。</li></ol><p>错误示范,识别不了<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"#request.req"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:textfield</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>正确的应该是</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"%&#123;#request.req&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:textfield</span>&gt;</span></span><br></pre></td></tr></table></figure><p>就是一个 %{} 里面写入ognl表达式</p><hr><h1 id="Struts2拦截器概述"><a href="#Struts2拦截器概述" class="headerlink" title="Struts2拦截器概述"></a>Struts2拦截器概述</h1><ol><li><p>struts2是框架，封装了很多的功能，struts2里面封装的功能都是在拦截器里面</p></li><li><p>struts2里面封装了很多的功能，有很多拦截器，不是每次这些拦截器都执行，每次执行默认的拦截器</p></li><li><p>struts2里面默认拦截器位置<br>在struts2-core-2.3.24.jar里面有个叫struts-default.xml的文件<br>最下面的内容是默认的拦截器</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">interceptor-stack</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"exception"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"alias"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"servletConfig"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"i18n"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"prepare"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"chain"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"scopedModelDriven"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"modelDriven"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"fileUpload"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"checkbox"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"datetime"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"multiselect"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"staticParams"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"actionMappingParams"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"params"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"conversionError"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"validation"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"excludeMethods"</span>&gt;</span>input,back,cancel,browse<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"workflow"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"excludeMethods"</span>&gt;</span>input,back,cancel,browse<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">interceptor-ref</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"debugging"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"deprecation"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">interceptor-stack</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>拦截器在什么时候执行？<br>在action对象创建之后，action的方法执行之前</p></li></ol><hr><h2 id="拦截器底层原理"><a href="#拦截器底层原理" class="headerlink" title="拦截器底层原理"></a>拦截器底层原理</h2><ol><li>拦截器底层使用两个原理<br>第一个: aop思想<br>文字描述：<br>Aop是面向切面（方面）编程，有基本功能，扩展功能，不通过修改源代码方式扩展功能</li></ol><p>看图理解</p> <img src="/posts/3a01fcdf/3.png"><p>第二个 ：责任链模式<br>（1）在java中有很多的设计模式，责任链模式是其中的一种<br>（2）责任链模式和过滤链很相似的<br>责任链模式：<br> 要执行多个操作，有添加、修改、删除三个操作。<br>首先执行添加操作，添加操作执行之后 做类似于放行操作，执行修改操作，修改操作执行之后做类似于放行操作，执行删除操作</p><p>过滤链：一个请求可有多个过滤器进行过滤，每个过滤器只有做放行才能到下一个过滤器</p><ol start="2"><li>aop思想和责任链模式如何应用到拦截器里面？</li></ol><p>1）文字描述：</p><ul><li><p>拦截器在action对象创建之后，action的方法执行之前执行</p></li><li><p>在action方法执行之前执行默认拦截器，执行过程使用aop思想，在action没有直接调用拦截器的方法，使用配置文件方式进行操作</p></li><li><p>在执行拦截器时候，执行很多的拦截器，这个过程使用责任链模式</p></li><li><p>假如执行三个拦截器，执行拦截器1，执行拦截器1之后做放行操作，执行拦截器2，执行拦截器2之后做放行，执行拦截器3，执行拦截器3之后放行，执行action的方法</p></li></ul><p>看图分析</p> <img src="/posts/3a01fcdf/4.png"><h2 id="重要的概念"><a href="#重要的概念" class="headerlink" title="重要的概念"></a>重要的概念</h2><ol><li><p>过滤器和拦截器区别<br>（1）过滤器：过滤器理论上可以任意内容，比如html、jsp、servlet、图片路径<br>（2）拦截器：拦截器只可以拦截action</p></li><li><p>Servlet和action区别<br>（1）servlet默认第一次访问时候创建，创建一次，单实例对象<br>（2）action每次访问时候创建，创建多次，多实例对象</p></li></ol><h2 id="自定义拦截器"><a href="#自定义拦截器" class="headerlink" title="自定义拦截器"></a>自定义拦截器</h2><ol><li><p>在struts2里面有很多的拦截器，这些拦截器是struts2封装的功能，但是在实际开发中，struts2里面的拦截器中可以没有要使用的功能，这个时候需要自己写拦截器实现功能</p></li><li><p>拦截器结构</p></li></ol><p>（1）从源码查看拦截器结构</p><ul><li>继承类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModelDrivenInterceptor</span> <span class="keyword">extends</span> <span class="title">AbstractIntercetor</span></span></span><br></pre></td></tr></table></figure></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbstractInterceptor</span> <span class="keyword">implements</span> <span class="title">Interceptor</span></span></span><br></pre></td></tr></table></figure><p>在接口里有三个方法<br>初始化：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>销毁：<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p></p><p>拦截逻辑操作：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">String <span class="title">intercept</span><span class="params">(ActionInvocation invocation)</span></span></span><br></pre></td></tr></table></figure><p>(2)开发中，建议使用另外一种方式</p><ul><li><p>写类，继承 MethodFilterInterceptor类实现</p></li><li><p>让action里面某个的方法不进行拦截</p></li></ul><p>（3）让拦截器和action有关系</p><ul><li>不是在action调用拦截器的方法，而是通过配置文件方式让建立关系</li></ul><h2 id="自定义登录拦截器"><a href="#自定义登录拦截器" class="headerlink" title="自定义登录拦截器"></a>自定义登录拦截器</h2><ol><li>需求：在项目中，有很多的action的超链接，实现只有是登录的状态，才可以点击action的超链接实现功能，如果不是登录状态，点击action超链接返回到登录页面</li></ol><ol start="2"><li><p>登录的状态：使用session域对象实现<br>（1）登录成功之后，把数据放到session里面<br>（2）判断session是否有值，可以知道是否是登录状态</p></li><li><p>实现登录的基本功能<br>查询数据库判断用户名和密码（另外实现）</p></li></ol> <img src="/posts/3a01fcdf/5.png"> <img src="/posts/3a01fcdf/6.png"><ol start="4"><li>添加登录拦截器功能</li></ol><p>（1）判断是否登录：判断session里面是否有名称是username的值</p><p>（2）拦截器实现过程</p><p>第一步 创建类，继承MethodFilterInterceptor类</p><p>第二步 重写MethodFilterInterceptor类里面的方法写拦截器逻辑</p> <img src="/posts/3a01fcdf/7.png"> <img src="/posts/3a01fcdf/8.png"><p>第三步 配置action和拦截器关系（注册拦截器）</p><p>（1）在要拦截的action标签所在的package标签里面声明拦截器</p> <img src="/posts/3a01fcdf/9.png"><p>（2）在具体的action标签里面使用声明的拦截器</p> <img src="/posts/3a01fcdf/10.png"><p>（3）struts2里面执行很多的默认拦截器，但是如果在action里面配置自定义拦截器.<br>问题：默认的拦截器不会执行了<br>解决：把默认拦截器手动使用一次</p> <img src="/posts/3a01fcdf/11.png"><ol start="5"><li>配置拦截器，对action里面所有的方法都进行拦截<br>（1）在action里面有login的登录的方法，这个方法不需要拦截，如果这个方法都拦截，问题是，永远登录不进去了<br>（2）解决：让login方法不进行拦截</li></ol><ul><li>直接通过配置方式让action里面某些方法不进行拦截</li></ul> <img src="/posts/3a01fcdf/12.png"><h1 id="Struts2的标签库"><a href="#Struts2的标签库" class="headerlink" title="Struts2的标签库"></a>Struts2的标签库</h1><p> struts2标签只能使用jsp页面中</p><ol><li><p>s:property： 和ognl表达式在jsp页面中获取值栈数据</p></li><li><p>s:iterator: 获取值栈list集合数据，表示list集合</p></li><li>s:debug: 查看值栈结构和数据</li></ol><h2 id="Struts2表单标签（会用）"><a href="#Struts2表单标签（会用）" class="headerlink" title="Struts2表单标签（会用）"></a>Struts2表单标签（会用）</h2><p>1 html表单标签</p><p>（1）form : action、method、enctype</p><p>（2）输入项</p><ul><li><p>大部分在input里面封装 type=”值”</p></li><li><p>text：普通输入项</p></li><li><p>password：密码输入项</p></li><li><p>radio：单选输入项</p></li><li><p>checkbox：复选输入项</p></li><li><p>file：文件上传项</p></li><li><p>hidden：隐藏项</p></li><li><p>button：普通按钮</p></li><li><p>submit：提交按钮</p></li><li><p>image：图片提交</p></li><li><p>reset：重置</p></li><li><p>select：下拉输入项</p></li><li><p>textarea：文本域</p></li></ul><p>2.在struts2里面对应html表单标签大部分都有</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">s:form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">label</span>=<span class="string">"username"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:textfield</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:password</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">label</span>=<span class="string">"mima"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:password</span>&gt;</span></span><br><span class="line">    // 值和名称一样</span><br><span class="line">    <span class="tag">&lt;<span class="name">s:radio</span> <span class="attr">list</span>=<span class="string">"&#123;'nv','nan'&#125;"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">label</span>=<span class="string">"xingbie"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:radio</span>&gt;</span></span><br><span class="line">    //值和名称不一样</span><br><span class="line">    <span class="tag">&lt;<span class="name">s:radio</span> <span class="attr">list</span>=<span class="string">"#&#123;'nv':'女','nan':'男'&#125;"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">label</span>=<span class="string">"xingbie"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:radio</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:checkboxlist</span> <span class="attr">list</span>=<span class="string">"&#123;'1','2','3','4'&#125;"</span> <span class="attr">name</span>=<span class="string">"fav"</span> <span class="attr">label</span>=<span class="string">"随便挑"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:checkboxlist</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">s:select</span> <span class="attr">list</span>=<span class="string">"&#123;'a','b','c','d'&#125;"</span> <span class="attr">name</span>=<span class="string">"abcd"</span> <span class="attr">label</span>=<span class="string">"abcd"</span>&gt;</span><span class="tag">&lt;/<span class="name">s:select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">s:textarea</span> <span class="attr">rows</span>=<span class="string">"3"</span> <span class="attr">cols</span>=<span class="string">"10"</span> <span class="attr">value</span>=<span class="string">"jianli"</span> <span class="attr">label</span>=<span class="string">"jianli"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:file</span> <span class="attr">name</span>=<span class="string">"file"</span> <span class="attr">label</span>=<span class="string">"dakai"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:hidden</span> <span class="attr">name</span>=<span class="string">"hid"</span> <span class="attr">value</span>=<span class="string">"asdb"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:hidden</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:submit</span> <span class="attr">name</span>=<span class="string">"sub"</span> <span class="attr">value</span>=<span class="string">"tijiao"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:submit</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">s:reset</span> <span class="attr">value</span>=<span class="string">"chongzhi"</span>&gt;</span> <span class="tag">&lt;/<span class="name">s:reset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">s:form</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>Just for fun!</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Qsx 微信支付"><p>微信支付</p></div></div></div></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------<i class="fa fa-paw"></i> 文章已经到尾<i class="fa fa-paw"></i> -------------</div></div></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/学习/" rel="tag"># 学习</a> <a href="/tags/框架/" rel="tag"># 框架</a> <a href="/tags/struts2/" rel="tag"># struts2</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/c240a0d6.html" rel="next" title="struts2学习"><i class="fa fa-chevron-left"></i> struts2学习</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/posts/115b549a.html" rel="prev" title="iBatis">iBatis<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Qsx"><p class="site-author-name" itemprop="name">Qsx</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">12</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Shelhon" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:ppp00qqq@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="http://weibo.com/qsxmybaby" target="_blank" title="微博"><i class="fa fa-fw fa-weibo"></i> 微博</a></span><span class="links-of-author-item"><a href="https://zhihu.com/people/shelhon" target="_blank" title="知乎"><i class="fa fa-fw fa-globe"></i> 知乎</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://www.kofes.cn/" title="cz" target="_blank">cz</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#struts2值栈"><span class="nav-number">1.</span> <span class="nav-text">struts2值栈</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ognl概述"><span class="nav-number">1.1.</span> <span class="nav-text">ognl概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OGNL入门案例"><span class="nav-number">1.2.</span> <span class="nav-text">OGNL入门案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是值栈"><span class="nav-number">1.3.</span> <span class="nav-text">什么是值栈</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#获取值栈对象"><span class="nav-number">1.3.1.</span> <span class="nav-text">获取值栈对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#值栈内部结构"><span class="nav-number">1.3.2.</span> <span class="nav-text">值栈内部结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#向值栈放数据"><span class="nav-number">1.3.3.</span> <span class="nav-text">向值栈放数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#向值栈放数据多种方式"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">向值栈放数据多种方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#向值栈放对象"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">向值栈放对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#向值栈放list集合"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">向值栈放list集合</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#从值栈获取数据"><span class="nav-number">1.3.4.</span> <span class="nav-text">从值栈获取数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#获取字符串"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">获取字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取对象"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">获取对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取list集合"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">获取list集合</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他操作"><span class="nav-number">1.3.5.</span> <span class="nav-text">其他操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OGNL的-、-使用"><span class="nav-number">1.4.</span> <span class="nav-text">OGNL的#、%使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#关于-号的使用"><span class="nav-number">1.4.1.</span> <span class="nav-text">关于 # 号的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于-的使用"><span class="nav-number">1.4.2.</span> <span class="nav-text">关于 % 的使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Struts2拦截器概述"><span class="nav-number">2.</span> <span class="nav-text">Struts2拦截器概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#拦截器底层原理"><span class="nav-number">2.1.</span> <span class="nav-text">拦截器底层原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重要的概念"><span class="nav-number">2.2.</span> <span class="nav-text">重要的概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自定义拦截器"><span class="nav-number">2.3.</span> <span class="nav-text">自定义拦截器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自定义登录拦截器"><span class="nav-number">2.4.</span> <span class="nav-text">自定义登录拦截器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Struts2的标签库"><span class="nav-number">3.</span> <span class="nav-text">Struts2的标签库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Struts2表单标签（会用）"><span class="nav-number">3.1.</span> <span class="nav-text">Struts2表单标签（会用）</span></a></li></ol></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Qsx</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">Site words total count&#58;</span> <span title="Site words total count">102.1k</span></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/love.js"></script></body></html>